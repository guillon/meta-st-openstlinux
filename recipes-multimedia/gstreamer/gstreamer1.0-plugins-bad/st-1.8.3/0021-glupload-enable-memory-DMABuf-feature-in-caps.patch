From a25389aee1b9c32a7c7969d3c2d2325d4d55108b Mon Sep 17 00:00:00 2001
From: Vincent Abriou <vincent.abriou@st.com>
Date: Wed, 30 Nov 2016 14:23:53 +0100
Subject: [PATCH 21/24] glupload: enable memory:DMABuf feature in caps

Change-Id: I935fd29bdd32a920b85362f09e0aacba7386766a
Signed-off-by: Vincent Abriou <vincent.abriou@st.com>
Reviewed-on: https://gerrit.st.com/61201
---
 gst-libs/gst/gl/gstglupload.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/gst-libs/gst/gl/gstglupload.c b/gst-libs/gst/gl/gstglupload.c
index 965afea..9694e72 100644
--- a/gst-libs/gst/gl/gstglupload.c
+++ b/gst-libs/gst/gl/gstglupload.c
@@ -671,7 +671,8 @@ struct DmabufUpload
 };
 
 static GstStaticCaps _dma_buf_upload_caps =
-GST_STATIC_CAPS (GST_VIDEO_CAPS_MAKE (GST_GL_MEMORY_VIDEO_FORMATS_STR));
+GST_STATIC_CAPS (GST_VIDEO_CAPS_MAKE_WITH_FEATURES
+    (GST_CAPS_FEATURE_MEMORY_DMABUF, GST_GL_MEMORY_VIDEO_FORMATS_STR));
 
 static gpointer
 _dma_buf_upload_new (GstGLUpload * upload)
@@ -705,7 +706,7 @@ _dma_buf_upload_transform_caps (GstGLContext * context,
 
     ret =
         _set_caps_features_with_passthrough (caps,
-        GST_CAPS_FEATURE_MEMORY_SYSTEM_MEMORY, passthrough);
+        GST_CAPS_FEATURE_MEMORY_DMABUF, passthrough);
 
     n = gst_caps_get_size (ret);
     for (i = 0; i < n; i++) {
-- 
2.7.4


From 53c5a4ebc82a1ac6374512ad03fd6e38ddcff0a1 Mon Sep 17 00:00:00 2001
From: Christophe Priouzeau <christophe.priouzeau@linaro.org>
Date: Thu, 7 Apr 2016 10:22:14 +0200
Subject: [PATCH 09/24] STM: waylandsink: increase bufferpool size

Use at least 3 buffers in the pool : this fixes some deadlock conditions
when using a drm backend weston compositor.

Change-Id: Id004673ed56f51cba1f9be15cfd9817a7ebd3c1b
Signed-off-by: Fabien Dessenne <fabien.dessenne@st.com>
---
 ext/wayland/gstwaylandsink.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ext/wayland/gstwaylandsink.c b/ext/wayland/gstwaylandsink.c
index ddb3701..cef88b1 100644
--- a/ext/wayland/gstwaylandsink.c
+++ b/ext/wayland/gstwaylandsink.c
@@ -469,7 +469,7 @@ gst_wayland_sink_set_caps (GstBaseSink * bsink, GstCaps * caps)
     goto pool_failed;
 
   structure = gst_buffer_pool_get_config (newpool);
-  gst_buffer_pool_config_set_params (structure, caps, info.size, 2, 0);
+  gst_buffer_pool_config_set_params (structure, caps, info.size, 3, 0);
   gst_buffer_pool_config_set_allocator (structure, gst_wl_shm_allocator_get (),
       NULL);
   if (!gst_buffer_pool_set_config (newpool, structure))
-- 
2.7.4

